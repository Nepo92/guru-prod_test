<html lang="ru" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Воронки продаж">

    <title>Воронки продаж</title>

    <th:block th:insert="base :: links" />
</head>

<body>
    <div th:replace="base :: main-nav"></div>

    <div class="main-content main-content_white-top-medium main-content_mw-unset">
        <div class="content-top">
            <div class="content-top__header">Воронки продаж</div>
            <div js-funnel-setting class="theme-setting theme-setting_violet"></div>
        </div>
        <div class="content-top content-top_small">
            <div th:replace="base :: funnel-tab"></div>
        </div>
        <div class="content-main">
            <div class="content-main__panel content-main__panel_large">
                <div class="button-filter" th:classappend="${filter.isCanClear() ? 'filtered' : ''}">
                    <button tr-filter-btn class="content-top__filter content-top__filter_small"></button>
                    <span class="button-filter__label">Фильтр</span>
                </div>

                <form action="#" th:action="@{/funnel/traffic/}" th:object="${filter}" th:method="post" class="content-main__panel-side">
                    <div class="input-element__input input-element__input_violet input-element__input_transp input-element__input_row input-element__input_l30">
                        <div class="input-element__radio input-element__radio_small">
                            <input filter-parameter type="radio" id="Месяц" class="radio radio-mech" th:field="*{idSort}" th:value="0" th:checked="${filter.idSort == 0}">
                            <label for="Месяц">Месяц</label>
                        </div>
                        <div class="input-element__radio-delim"></div>
                        <div class="input-element__radio input-element__radio_small">
                            <input filter-parameter type="radio" id="Неделя" class="radio radio-mech" th:field="*{idSort}" th:value="1" th:checked="${filter.idSort == 1}">
                            <label for="Неделя">Неделя</label>
                        </div>
                        <div class="input-element__radio-delim"></div>
                        <div class="input-element__radio input-element__radio_small">
                            <input filter-parameter type="radio" id="День" class="radio radio-mech" th:field="*{idSort}" th:value="2" th:checked="${filter.idSort == 2}">
                            <label for="День">День</label>
                        </div>
                    </div>

                    <div class="input-element__input input-element__input_violet input-element__input_transp input-element__input_row input-element__input_l30">
                        <div class="input-element__radio input-element__radio_small">
                            <a class="radio-link " th:classappend="${type == 'table'} ? active : ''" th:href="@{/funnel/traffic/}">Таблица</a>
                        </div>
                        <div class="input-element__radio-delim"></div>
                        <div class="input-element__radio input-element__radio_small">
                            <a class="radio-link " th:classappend="${type == 'chart'} ? active : ''" th:href="@{/funnel/traffic/chart/}">График</a>
                        </div>
                    </div>
                </form>
            </div>
            <div class="container-fluid">
                <div class="row">
                    <div class="custom-lg-10 custom-lg-10_big" th:classappend="${filter.active} ? '' : custom-lg-10_active">
                        <div class="table-response d-flex">
                            <div class="table table_fixed d-flex flex-column">
                                <div class="table-header">
                                    <div class="table-header__row">
                                        <div class="table-header__cell mr-2" th:utext="${filter.startDate} + '<br>' + ${filter.endDate}"></div>
                                        <div class="table-header__cell table-header__cell_caption mr-2"></div>
                                    </div>
                                </div>
                                <div class="table-body">
                                    <th:block th:if="${filter.visableSetting.blockProceed}">
                                        <div class="table-body__row mb-2 mt-2 row_green">
                                            <button class="table-body__accordion" data-toggle="collapse" data-target="#mProceeds" aria-expanded="false" aria-controls="mProceeds">+</button>
                                            <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(proceeds.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption mr-2">Выручка</div>
                                        </div>
                                        <div id="mProceeds" class="collapse">
                                            <div class="table-body__row row_light-gray" th:each="manager : ${mProceeds}">
                                                <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                                <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                            </div>
                                        </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPrepaymentProceed}">
                                        <div class="table-body__row mb-2 mt-2 row_green">
                                            <button class="table-body__accordion" data-toggle="collapse" data-target="#mPrepaymentProceeds" aria-expanded="false" aria-controls="mPrepaymentProceeds">+</button>
                                            <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(prepaymentProceeds.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption mr-2">Выручка предоплаты</div>
                                        </div>
                                        <div id="mPrepaymentProceeds" class="collapse">
                                            <div class="table-body__row row_light-gray" th:each="manager : ${mPrepaymentProceeds}">
                                                <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                                <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                            </div>
                                        </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSurchargeProceed}">
                                        <div class="table-body__row mb-2 mt-2 row_green">
                                            <button class="table-body__accordion" data-toggle="collapse" data-target="#mSurchargeProceeds" aria-expanded="false" aria-controls="mSurchargeProceeds">+</button>
                                            <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(surchargeProceeds.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption mr-2">Выручка доплаты</div>
                                        </div>
                                        <div id="mSurchargeProceeds" class="collapse">
                                            <div class="table-body__row row_light-gray" th:each="manager : ${mSurchargeProceeds}">
                                                <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                                <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                            </div>
                                        </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAdvertisingExpenses}">
                                        <div class="table-body__row mb-2 mt-2 row_pink">
                                            <button class="table-body__accordion" data-toggle="collapse" data-target="#mAdvPrice" aria-expanded="false" aria-controls="mAdvPrice">+</button>
                                            <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(advPrice.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption mr-2">Расходы на рекламу</div>
                                        </div>
                                        <div id="mAdvPrice" class="collapse">
                                            <div class="table-body__row row_light-gray" th:each="manager : ${mAdvPrice}">
                                                <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                                <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                            </div>
                                        </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockProceedAdvertisingExpenses}">
                                        <div class="table-body__row mb-2 mt-2 row_blue">
                                            <button class="table-body__accordion" data-toggle="collapse" data-target="#mProfit" aria-expanded="false" aria-controls="mProfit">+</button>
                                            <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(profit.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption mr-2">Выручка - Расходы на рекламу</div>
                                        </div>
                                        <div id="mProfit" class="collapse">
                                            <div class="table-body__row row_light-gray" th:each="manager : ${mProfit}">
                                                <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                                <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                            </div>
                                        </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPercentNetProceed}">
                                        <div class="table-body__row mb-2 mt-2 row_gray">
                                            <button class="table-body__accordion" data-toggle="collapse" data-target="#mProfitPercent" aria-expanded="false" aria-controls="mProfitPercent">+</button>
                                            <div class="table-body__cell font-weight-bold mr-2"
                                                 th:classappend="${(proceedsColor.getDoubleGreen() != null && profitPercent.sum >= proceedsColor.getDoubleGreen())} ? green : (${(proceedsColor.getDoubleYellow() != null && profitPercent.sum >= proceedsColor.getDoubleYellow())} ? yellow : (${(proceedsColor.getDoubleRed() != null && profitPercent.sum >= proceedsColor.getDoubleRed())} ? red : ''))"
                                                 th:utext="${profitPercent.sum + '%'}"></div>
                                            <div class="table-body__cell table-body__cell_caption mr-2">% чистой выручки</div>
                                        </div>
                                        <div id="mProfitPercent" class="collapse">
                                            <div class="table-body__row row_light-gray" th:each="manager : ${mProfitPercent}">
                                                <div class="table-body__cell mr-2"
                                                     th:classappend="${(proceedsColor.getDoubleGreen() != null && manager.value.sum >= proceedsColor.getDoubleGreen())} ? green : (${(proceedsColor.getDoubleYellow() != null && manager.value.sum >= proceedsColor.getDoubleYellow())} ? yellow : (${(proceedsColor.getDoubleRed() != null && manager.value.sum >= proceedsColor.getDoubleRed())} ? red : ''))"
                                                     th:utext="${manager.value.sum + '%'}"></div>
                                                <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                            </div>
                                        </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockKPD}">
                                    <div class="table-body__row mb-2 mt-2 row_gray">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mKPD" aria-expanded="false" aria-controls="mKPD">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2"
                                             th:classappend="${(kpdColor.getDoubleGreen() != null && kpd.sum >= kpdColor.getDoubleGreen())} ? green : (${(kpdColor.getDoubleYellow() != null && kpd.sum >= kpdColor.getDoubleYellow())} ? yellow : (${(kpdColor.getDoubleRed() != null && kpd.sum >= kpdColor.getDoubleRed())} ? red : ''))"
                                             th:utext="${kpd.sum}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">КПД</div>
                                    </div>
                                    <div id="mKPD" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mKPD}">
                                            <div class="table-body__cell mr-2"
                                                 th:classappend="${(kpdColor.getDoubleGreen() != null && manager.value.sum >= kpdColor.getDoubleGreen())} ? green : (${(kpdColor.getDoubleYellow() != null && manager.value.sum >= kpdColor.getDoubleYellow())} ? yellow : (${(kpdColor.getDoubleRed() != null && manager.value.sum >= kpdColor.getDoubleRed())} ? red : ''))"
                                                 th:utext="${manager.value.sum}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockShows}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mAdvShows" aria-expanded="false" aria-controls="mAdvShows">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(advShows.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Показов</div>
                                    </div>
                                    <div id="mAdvShows" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAdvShows}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClicks}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mAdvClick" aria-expanded="false" aria-controls="mAdvClick">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(advClick.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Кликов</div>
                                    </div>
                                    <div id="mAdvClick" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAdvClick}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplications}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mAdvApplication" aria-expanded="false" aria-controls="mAdvApplication">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(advApplication.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Заявок</div>
                                    </div>
                                    <div id="mAdvApplication" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAdvApplication}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockBills}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mInvoices" aria-expanded="false" aria-controls="mMailings">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(invoices.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Заказов</div>
                                    </div>
                                    <div id="mInvoices" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mInvoices}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSales}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#salesMNewClient" aria-expanded="false" aria-controls="salesMNewClient">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(salesNewClient.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Оплат</div>
                                    </div>
                                    <div id="salesMNewClient" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMNewClient}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesWithoutSales}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#salesMNewClientNM" aria-expanded="false" aria-controls="salesMNewClientNM">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(salesNewClientNM.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Оплат без рассылки</div>
                                    </div>
                                    <div id="salesMNewClientNM" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMNewClientNM}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesWithSales}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#salesMNewClientM" aria-expanded="false" aria-controls="salesMNewClientM">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(salesNewClientM.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Оплат c рассылки</div>
                                    </div>
                                    <div id="salesMNewClientM" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMNewClientM}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSurcharges}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#salesMSurcharge" aria-expanded="false" aria-controls="salesMSurcharge">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(salesSurcharge.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Доплат</div>
                                    </div>
                                    <div id="salesMSurcharge" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMSurcharge}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClientsDO}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#newMClientsDo" aria-expanded="false" aria-controls="newMClientsDo">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(newClientsDo.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Новых клиентов по ДО</div>
                                    </div>
                                    <div id="newMClientsDo" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsDo}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClientsTraffic}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#newMClientsTraffic" aria-expanded="false" aria-controls="newMClientsTraffic">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(newClientsTraffic.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Новых клиентов с трафика за период</div>
                                    </div>
                                    <div id="newMClientsTraffic" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsTraffic}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesDo}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#newMClientsAll" aria-expanded="false" aria-controls="newMClientsAll">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(newClientsAll.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Дотекло клиентов по ДО</div>
                                    </div>
                                    <div id="newMClientsAll" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsAll}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesDoWithoutMailing}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#newMClientsWithoutMailing" aria-expanded="false" aria-controls="newMClientsWithoutMailing">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(newClientsWithoutMailing.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Дотекло клиентов по ДО (без рассылки)</div>
                                    </div>
                                    <div id="newMClientsWithoutMailing" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsWithoutMailing}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesDoWithMailing}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#newMClientsWithMailing" aria-expanded="false" aria-controls="newMClientsWithMailing">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(newClientsWithMailing.sum,0,'WHITESPACE')}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Дотекло клиентов по ДО (по рассылке)</div>
                                    </div>
                                    <div id="newMClientsWithMailing" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsWithMailing}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE')}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAverage}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mAverage" aria-expanded="false" aria-controls="mAverage">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(averageCheck.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Средний чек</div>
                                    </div>
                                    <div id="mAverage" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAverage}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAveragePrepayment}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mAveragePrepayment" aria-expanded="false" aria-controls="mAveragePrepayment">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(averageCheckPrepayment.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Средний чек предоплаты</div>
                                    </div>
                                    <div id="mAveragePrepayment" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAveragePrepayment}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAverageSurcharge}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mAverageSurcharge" aria-expanded="false" aria-controls="mAverageSurcharge">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(averageCheckSurcharge.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Средний чек доплаты</div>
                                    </div>
                                    <div id="mAverageSurcharge" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAverageSurcharge}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceShows}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mShowPrice" aria-expanded="false" aria-controls="mShowPrice">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(showPrice.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Стоимость 1000 показов</div>
                                    </div>
                                    <div id="mShowPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mShowPrice}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceClick}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mClickPrice" aria-expanded="false" aria-controls="mClickPrice">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(clickPrice.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Стоимость клика</div>
                                    </div>
                                    <div id="mClickPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClickPrice}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceApplication}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mApplicationPrice" aria-expanded="false" aria-controls="mApplicationPrice">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(applicationPrice.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Стоимость заявки</div>
                                    </div>
                                    <div id="mApplicationPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mApplicationPrice}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceBill}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mInvoicePrice" aria-expanded="false" aria-controls="mInvoicePrice">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(invoicePrice.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Стоимость заказа</div>
                                    </div>
                                    <div id="mInvoicePrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mInvoicePrice}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClient}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mClientPrice" aria-expanded="false" aria-controls="mClientPrice">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(clientPrice.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Стоимость клиента</div>
                                    </div>
                                    <div id="mClientPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClientPrice}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClientDO}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mClientPriceDo" aria-expanded="false" aria-controls="mClientPriceDo">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${#numbers.formatInteger(clientPriceDo.sum,0,'WHITESPACE') + ' р.'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">Стоимость клиента по ДО</div>
                                    </div>
                                    <div id="mClientPriceDo" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClientPriceDo}">
                                            <div class="table-body__cell mr-2" th:utext="${#numbers.formatInteger(manager.value.sum,0,'WHITESPACE') + ' р.'}"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockShowToClick}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mShowToClick" aria-expanded="false" aria-controls="mShowToClick">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${showToClick.sum + '%'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">CV из показа в клик</div>
                                    </div>
                                    <div id="mShowToClick" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mShowToClick}">
                                            <div class="table-body__cell mr-2" th:utext="${manager.value.sum} + '%'"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClickToApplication}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mClickToApplication" aria-expanded="false" aria-controls="mClickToApplication">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${clickToApplication.sum + '%'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">CV1 из клика в заявку</div>
                                    </div>
                                    <div id="mClickToApplication" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClickToApplication}">
                                            <div class="table-body__cell mr-2" th:utext="${manager.value.sum} + '%'"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplicationToBill}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mApplicationToInvoice" aria-expanded="false" aria-controls="mApplicationToInvoice">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${applicationToInvoice.sum + '%'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">CV2 из заявки в заказ</div>
                                    </div>
                                    <div id="mApplicationToInvoice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mApplicationToInvoice}">
                                            <div class="table-body__cell mr-2" th:utext="${manager.value.sum} + '%'"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockBillToClient}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mInvoiceToClient" aria-expanded="false" aria-controls="mInvoiceToClient">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${invoiceToClient.sum + '%'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">CV3 из заказа в оплату</div>
                                    </div>
                                    <div id="mInvoiceToClient" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mInvoiceToClient}">
                                            <div class="table-body__cell mr-2" th:utext="${manager.value.sum} + '%'"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplicationToClient}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mApplicationToClient" aria-expanded="false" aria-controls="mApplicationToClient">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${applicationToClient.sum + '%'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">CV4 из заявки в оплату</div>
                                    </div>
                                    <div id="mApplicationToClient" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mApplicationToClient}">
                                            <div class="table-body__cell mr-2" th:utext="${manager.value.sum} + '%'"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplicationToClientDO}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <button class="table-body__accordion" data-toggle="collapse" data-target="#mClickToApplicationDo" aria-expanded="false" aria-controls="mClickToApplicationDo">+</button>
                                        <div class="table-body__cell font-weight-bold mr-2" th:utext="${clickToApplicationDo.sum + '%'}"></div>
                                        <div class="table-body__cell table-body__cell_caption mr-2">CV4 из заявки в оплату по ДО</div>
                                    </div>
                                    <div id="mClickToApplicationDo" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClickToApplicationDo}">
                                            <div class="table-body__cell mr-2" th:utext="${manager.value.sum} + '%'"></div>
                                            <div class="table-body__cell table-body__cell_caption2 mr-2" th:utext="${manager.key}"></div>
                                        </div>
                                    </div>
                                    </th:block>
                                </div>
                            </div>
                            <div class="table">
                                <div class="table-header">
                                    <div class="table-header__row">
                                        <div class="table-header__cell" th:each="date : ${dates}" th:utext="${date.start_date} + '<br>' + ${date.end_date}"></div>
                                    </div>
                                </div>
                                <div class="table-body">
                                    <th:block th:if="${filter.visableSetting.blockProceed}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${proceeds.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mProceeds" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mProceeds}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPrepaymentProceed}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${prepaymentProceeds.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mPrepaymentProceeds" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mPrepaymentProceeds}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSurchargeProceed}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${surchargeProceeds.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mSurchargeProceeds" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mSurchargeProceeds}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAdvertisingExpenses}">
                                    <div class="table-body__row mb-2 mt-2 row_pink">
                                        <div class="table-body__cell" th:each="a : ${advPrice.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mAdvPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAdvPrice}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockProceedAdvertisingExpenses}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${profit.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mProfit" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mProfit}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPercentNetProceed}">
                                    <div class="table-body__row mb-2 mt-2 row_gray">
                                        <div class="table-body__cell"
                                             th:classappend="${(proceedsColor.getDoubleGreen() != null && a >= proceedsColor.getDoubleGreen())} ? green : (${(proceedsColor.getDoubleYellow() != null && a >= proceedsColor.getDoubleYellow())} ? yellow : (${(proceedsColor.getDoubleRed() != null && a >= proceedsColor.getDoubleRed())} ? red : ''))"
                                             th:each="a : ${profitPercent.sums}" th:utext="${a + '%'}"></div>
                                    </div>
                                    <div id="mProfitPercent" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mProfitPercent}">
                                            <th:block  th:each="a : ${manager.value.sums}">
                                                <div class="table-body__cell"
                                                     th:if="${a != 0}"
                                                     th:classappend="${(proceedsColor.getDoubleGreen() != null && a >= proceedsColor.getDoubleGreen())} ? green : (${(proceedsColor.getDoubleYellow() != null && a >= proceedsColor.getDoubleYellow())} ? yellow : (${(proceedsColor.getDoubleRed() != null && a >= proceedsColor.getDoubleRed())} ? red : ''))"
                                                     th:text="${a + '%'}"></div>
                                                <div class="table-body__cell"
                                                     th:unless="${a != 0}"></div>
                                            </th:block>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockKPD}">
                                    <div class="table-body__row mb-2 mt-2 row_gray">
                                        <div class="table-body__cell"
                                             th:classappend="${(kpdColor.getDoubleGreen() != null && a >= kpdColor.getDoubleGreen())} ? green : (${(kpdColor.getDoubleYellow() != null && a >= kpdColor.getDoubleYellow())} ? yellow : (${(kpdColor.getDoubleRed() != null && a >= kpdColor.getDoubleRed())} ? red : ''))"
                                             th:each="a : ${kpd.sums}" th:utext="${a}"></div>
                                    </div>
                                    <div id="mKPD" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mKPD}">
                                            <th:block th:each="a : ${manager.value.sums}">
                                                <div class="table-body__cell"
                                                     th:if="${a != 0}"
                                                     th:classappend="${(kpdColor.getDoubleGreen() != null && a >= kpdColor.getDoubleGreen())} ? green : (${(kpdColor.getDoubleYellow() != null && a >= kpdColor.getDoubleYellow())} ? yellow : (${(kpdColor.getDoubleRed() != null && a >= kpdColor.getDoubleRed())} ? red : ''))"
                                                     th:text="${a}"></div>
                                                <div class="table-body__cell"
                                                     th:unless="${a != 0}"></div>
                                            </th:block>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockShows}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${advShows.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="mAdvShows" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAdvShows}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClicks}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${advClick.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="mAdvClick" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAdvClick}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplications}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${advApplication.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="mAdvApplication" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAdvApplication}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockBills}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${invoices.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="mInvoices" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mInvoices}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSales}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${salesNewClient.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="salesMNewClient" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMNewClient}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesWithoutSales}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${salesNewClientNM.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="salesMNewClientNM" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMNewClientNM}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesWithSales}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${salesNewClientM.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="salesMNewClientM" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMNewClientM}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSurcharges}">
                                    <div class="table-body__row mb-2 mt-2 row_blue">
                                        <div class="table-body__cell" th:each="a : ${salesSurcharge.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="salesMSurcharge" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${salesMSurcharge}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClientsDO}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <div class="table-body__cell" th:each="a : ${newClientsDo.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="newMClientsDo" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsDo}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClientsTraffic}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <div class="table-body__cell" th:each="a : ${newClientsTraffic.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="newMClientsTraffic" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsTraffic}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesDo}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <div class="table-body__cell" th:each="a : ${newClientsAll.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="newMClientsAll" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsAll}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesDoWithoutMailing}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <div class="table-body__cell" th:each="a : ${newClientsWithoutMailing.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="newMClientsWithoutMailing" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsWithoutMailing}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockSalesDoWithMailing}">
                                    <div class="table-body__row mb-2 mt-2 row_violet">
                                        <div class="table-body__cell" th:each="a : ${newClientsWithMailing.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                    </div>
                                    <div id="newMClientsWithMailing" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${newMClientsWithMailing}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE')}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAverage}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <div class="table-body__cell" th:each="a : ${averageCheck.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mAverage" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAverage}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAveragePrepayment}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <div class="table-body__cell" th:each="a : ${averageCheckPrepayment.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mAveragePrepayment" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAveragePrepayment}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockAverageSurcharge}">
                                    <div class="table-body__row mb-2 mt-2 row_green">
                                        <div class="table-body__cell" th:each="a : ${averageCheckSurcharge.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mAverageSurcharge" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mAverageSurcharge}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceShows}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <div class="table-body__cell" th:each="a : ${showPrice.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mShowPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mShowPrice}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceClick}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <div class="table-body__cell" th:each="a : ${clickPrice.sums}" th:utext="${a + ' р.'}"></div>
                                    </div>
                                    <div id="mClickPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClickPrice}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${a + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceApplication}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <div class="table-body__cell" th:each="a : ${applicationPrice.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mApplicationPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mApplicationPrice}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockPriceBill}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <div class="table-body__cell" th:each="a : ${invoicePrice.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mInvoicePrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mInvoicePrice}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClient}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <div class="table-body__cell" th:each="a : ${clientPrice.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mClientPrice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClientPrice}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClientDO}">
                                    <div class="table-body__row mb-2 mt-2 row_purple">
                                        <div class="table-body__cell" th:each="a : ${clientPriceDo.sums}" th:utext="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                    </div>
                                    <div id="mClientPriceDo" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClientPriceDo}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${#numbers.formatInteger(a,0,'WHITESPACE') + ' р.'}"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockShowToClick}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${showToClick.sums}" th:utext="${a + '%'}"></div>
                                    </div>
                                    <div id="mShowToClick" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mShowToClick}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${a} + '%'"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockClickToApplication}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${clickToApplication.sums}" th:utext="${a + '%'}"></div>
                                    </div>
                                    <div id="mClickToApplication" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClickToApplication}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${a} + '%'"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplicationToBill}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${applicationToInvoice.sums}" th:utext="${a + '%'}"></div>
                                    </div>
                                    <div id="mApplicationToInvoice" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mApplicationToInvoice}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${a} + '%'"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockBillToClient}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${invoiceToClient.sums}" th:utext="${a + '%'}"></div>
                                    </div>
                                    <div id="mInvoiceToClient" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mInvoiceToClient}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${a} + '%'"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplicationToClient}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${applicationToClient.sums}" th:utext="${a + '%'}"></div>
                                    </div>
                                    <div id="mApplicationToClient" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mApplicationToClient}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${a} + '%'"></div>
                                        </div>
                                    </div>
                                    </th:block>

                                    <th:block th:if="${filter.visableSetting.blockApplicationToClientDO}">
                                    <div class="table-body__row mb-2 mt-2 row_gold">
                                        <div class="table-body__cell font-weight-bold" th:each="a : ${clickToApplicationDo.sums}" th:utext="${a + '%'}"></div>
                                    </div>
                                    <div id="mClickToApplicationDo" class="collapse">
                                        <div class="table-body__row row_light-gray" th:each="manager : ${mClickToApplicationDo}">
                                            <div class="table-body__cell" th:each="a : ${manager.value.sums}" th:text="${a} + '%'"></div>
                                        </div>
                                    </div>
                                    </th:block>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<div tr-filter class="cfilter">
        <div class="cfilter__wrapper">
            <div tr-filter-close-btn class="menu-header__close-btn menu-header__close-btn_absolute"></div>
            <div class="filter-content">
                <div class="filter-head">
                    <div class="filter-head__title">Фильтровать воронку</div>
                </div>
                <div class="filter-content__body custom-scroll">
                    <form tr-filter-form funnel-filter-form action="#" th:action="@{/funnel/traffic/}" th:object="${filter}" th:method="post" class="filter-body">
                        <div class="filter-body__wrapper filter-body__wrapper_start">
                            <div class="filter-column">
                                <div class="filter-column__title">Параметры</div>
                                <div class="filter-column__row">
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Год</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{year}">
                                                <option th:each="y : ${ys}" th:value="${y}" th:utext="${y}"></option>-->
                                            </select>
                                        </div>
                                    </div>
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Менеджер</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select js-manager class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{idManager}">
                                                <option th:value="0" selected>Все менеджеры</option>
                                                <option th:each="manager : ${managers}"
                                                        th:value="${manager.id}"
                                                        th:utext="${manager.name}"></option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="filter-column__row">
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Проект</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select js-project class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{project}">
                                                <option th:value="0" selected>Все проекты</option>
                                                <option th:each="project : ${projects}"
                                                        th:value="${project.id}"
                                                        th:utext="${project.name}"></option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Продукт</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select js-course  class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{course}">
                                                <option th:value="'all'" selected>Все продукты</option>
                                                <option th:each="course : ${courses}"
                                                        th:value="${course}"
                                                        th:utext="${course}"></option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="filter-column__row">
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Цели</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{target}">
                                                <option th:value="all" selected>Все цели</option>
                                                <option th:value="Подписка">Подписка</option>
                                                <option th:value="Заявка">Заявка</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="filter-column">
                                <div class="filter-column__title"></div>
                                <div class="filter-column__row">
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Рекламный кабинет</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select js-advertiser  class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{idUser}">
                                                <th:block th:if="${(role == 'ROLE_ADMIN') || (role == 'ROLE_ADVERTISER' && access)}">
                                                    <option th:value="0">Все кабинеты</option>
                                                    <option th:each="advertiser : ${advertisers}"
                                                            th:value="${advertiser.id}"
                                                            th:utext="${advertiser.name}"></option>
                                                </th:block>
                                                <th:block th:if="${role == 'ROLE_ADVERTISER' && !access}">
                                                    <th:block th:each="advertiser : ${advertisers}">
                                                        <option  th:if="${advertiser.id == filter.idUser}"
                                                                 th:value="${advertiser.id}"
                                                                 th:utext="${advertiser.name}"></option>
                                                    </th:block>
                                                </th:block>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="filter-column__row">
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Площадка</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select js-platform class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{platform}">
                                                <option th:value="'all'">Все площадки</option>
                                                <option th:value="'unknown'">Неизвестно</option>
                                                <option th:each="platform : ${platforms}"
                                                        th:value="${platform}"
                                                        th:utext="${platform}"></option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="filter-column__row">
                                    <div class="menu-input menu-input_lsmall">
                                        <div class="menu-input__title">Источники трафика</div>
                                        <div class="menu-input__wrapper menu-input__wrapper_select">
                                            <select js-channel class="menu-input__input menu-input__input_small menu-input__input_select menu-input__input_white" th:field="*{channel}">
                                                <th:block th:if="${filter.channel == 'unknown'}">
                                                    <option th:value="'unknown'">Неизвестно</option>
                                                </th:block>
                                                <th:block th:if="${filter.channel != 'unknown'}">
                                                    <option th:value="'all'">Все источники</option>
                                                    <option th:each="channel : ${channels}"
                                                            th:value="${channel}"
                                                            th:utext="${channel}"></option>
                                                </th:block>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="filter-column__row">
                                    <div class="menu-input menu-input_lsmall">
                                        <input js-communites type="hidden" class="menu-input__input menu-input__input_small menu-input__input_community" th:field="*{communites}">
                                        <div class="menu-input__title">Аудитории</div>
                                        <div class="menu-input__wrapper">
                                            <input js-community class="menu-input__input menu-input__input_small menu-input__input_community" th:field="*{community}" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="filter-content__footer">
                    <div tr-filter-form-btn class="button">Применить фильтры</div>
                    <div th:if="${filter.isCanClear()}" class="clear-filter clear-filter_bordered">
                        <form tr-clear-form action="#" th:action="@{/funnel/traffic/clearFilter}" th:method="post" class="clear-filter__form">
                            <button tr-clear-form-btn class="button button_clear">Сбросить фильтры</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

<div js-menu class="menu">
        <div class="menu__wrapper menu__wrapper_overflow-hidden">
                <div class="menu__header-wrapper">
                    <div class="menu-header">
                        <div class="menu-header__title">
                            Список аудиторий
                        </div>
                        <div js-menu-close-btn class="menu-header__close-btn"></div>
                    </div>
                </div>
                <div class="menu-search">
                    <input js-menu-search id="search" type="text" class="menu-search__input" placeholder="Введите название"/>
                    <label for="search"></label>
                </div>
                <div js-menu-content class="menu-content">
                    <div class="menu-content__wrapper is-selected">
                        <form filter-form-communities class="white-table_full" action="#" th:action="@{/funnel/traffic/communities/}" th:object="${filter}" th:method="post">
                            <table class="white-table white-table_full white-table_half-top mb-4">
                                <thead class="white-table__header">
                                <tr class="header__row">
                                    <th class="header__text"></th>
                                    <th class="header__text">Аудитория</th>
                                    <th class="header__text">Ссылка</th>
                                </tr>
                                </thead>
                                <tbody community-table class="white-table__body">

                                </tbody>
                            </table>
                        </form>
                    </div>
                </div>
        </div>
    </div>

<div js-menu-funnel-setting class="menu">
        <div class="menu__wrapper">
            <div js-menu-funnel-setting-close-btn class="menu-header__close-btn menu-header__close-btn_absolute"></div>
            <div class="menu__content menu__content_end">
                <form js-funnel-setting-form th:action="@{/funnel/traffic/}" th:object="${filter}" th:method="post" class="menu__content-side menu__content-side_large">
                    <div class="menu__header-wrapper">
                        <div class="menu-header">
                            <div class="menu-header__title">
                                Настройки воронки
                            </div>
                        </div>
                    </div>
                    <div class="menu__list menu__list_p0 custom-scroll">
                        <div class="menu-input menu-input_xsmall menu-input_t30">
                            <div class="menu-input__title">Тип *</div>
                            <div class="menu-input__wrapper menu-input__wrapper_select">
                                <select th:field="*{periodType}" class="menu-input__input menu-input__input_small menu-input__input_select" required>
                                    <option th:value="s">Сумма за период</option>
                                    <option th:value="a">Среднее за период</option>
                                </select>
                            </div>
                        </div>
                        <div class="menu-input menu-input_xsmall ">
                            <div class="menu-input__title">Дата от *</div>
                            <th:block th:if="${filter.idSort == 0}">
                                <div class="menu-input__wrapper menu-input__wrapper_select">
                                    <select th:field="*{startDate}" class="menu-input__input menu-input__input_small menu-input__input_select" required>
                                        <option th:each="fmd : ${firstMonthsDate}"
                                                th:value="${fmd.value}"
                                                th:utext="${fmd.key}"></option>
                                    </select>
                                </div>
                            </th:block>
                            <th:block th:if="${filter.idSort == 1}">
                                <div class="menu-input__wrapper menu-input__wrapper_select">
                                    <select th:field="*{startDate}" class="menu-input__input menu-input__input_small menu-input__input_select" required>
                                        <option th:each="fwd : ${firstWeeksDate}"
                                                th:value="${fwd.value}"
                                                th:utext="${fwd.key}"></option>
                                    </select>
                                </div>
                            </th:block>
                            <th:block th:if="${filter.idSort == 2}">
                                <div class="menu-input__wrapper menu-input__wrapper_cal">
                                    <input th:field="*{startDate}" autocomplete="off" data-date-format="dd-mm-yyyy" class="datepicker-here menu-input__input menu-input__input_small" placeholder="Выберите дату" required/>
                                </div>
                            </th:block>
                        </div>
                        <div class="menu-input menu-input_xsmall">
                            <div class="menu-input__title">Дата до *</div>
                            <th:block th:if="${filter.idSort == 0}">
                                <div class="menu-input__wrapper menu-input__wrapper_select">
                                    <select th:field="*{endDate}" class="menu-input__input menu-input__input_small menu-input__input_select" required>
                                        <option th:each="lmd : ${lastMonthsDate}"
                                                th:value="${lmd.value}"
                                                th:utext="${lmd.key}"></option>
                                    </select>
                                </div>
                            </th:block>
                            <th:block th:if="${filter.idSort == 1}">
                                <div class="menu-input__wrapper menu-input__wrapper_select">
                                    <select th:field="*{endDate}" class="menu-input__input menu-input__input_small menu-input__input_select" required>
                                        <option th:each="lwd : ${lastWeeksDate}"
                                                th:value="${lwd.value}"
                                                th:utext="${lwd.key}"></option>
                                    </select>
                                </div>
                            </th:block>
                            <th:block th:if="${filter.idSort == 2}">
                                <div class="menu-input__wrapper menu-input__wrapper_cal">
                                    <input th:field="*{endDate}" autocomplete="off" data-date-format="dd-mm-yyyy" class="datepicker-here menu-input__input menu-input__input_small" placeholder="Выберите дату" required/>
                                </div>
                            </th:block>
                        </div>

                        <div class="menu-input menu-input_xsmall menu-input_b0 menu-input_t30">
                            <div class="menu-input__title menu-input__title_black">Цвет показателей</div>
                        </div>
                        <th:block th:each="item, status : ${filter.lineColors}">
                            <div class="menu-input menu-input_xsmall menu-input_b0">
                                <div class="menu-input__title" th:utext="${filter.lineColors[__${status.index}__].name}"></div>
                                <input type="hidden" th:field="*{lineColors[__${status.index}__].id}" required>
                            </div>
                            <div class="menu-input__wrapper menu-input__wrapper_row menu-input__wrapper_margin">
                                <div class="menu-input menu-input_m menu-input_full">
                                    <div class="menu-input__title">Зеленый</div>
                                    <div class="menu-input__wrapper ">
                                        <input th:field="*{lineColors[__${status.index}__].green}" class="menu-input__input menu-input__input_small" placeholder="Введите значение" required="">
                                    </div>
                                </div>
                                <div class="menu-input menu-input_m menu-input_full">
                                    <div class="menu-input__title">Желтый</div>
                                    <div class="menu-input__wrapper ">
                                        <input th:field="*{lineColors[__${status.index}__].yellow}" class="menu-input__input menu-input__input_small" placeholder="Введите значение" required="">
                                    </div>
                                </div>
                                <div class="menu-input menu-input_m  menu-input_full">
                                    <div class="menu-input__title">Красный</div>
                                    <div class="menu-input__wrapper ">
                                        <input th:field="*{lineColors[__${status.index}__].red}" class="menu-input__input menu-input__input_small" placeholder="Введите значение" required="">
                                    </div>
                                </div>
                            </div>
                        </th:block>

                        <div class="menu-input menu-input_xsmall menu-input_b0 menu-input_t30">
                            <div class="menu-input__title menu-input__title_black">Этапы воронки</div>
                        </div>
                        <div class="menu-input menu-input_xsmall">
                            <div class="menu-input__title funnel-block__btn collapsed" data-toggle="collapse"
                                 data-target="#proceeds" aria-expanded="false"
                                 aria-controls="proceeds">Выручка и расходы на рекламу</div>
                            <div class="menu-input__checkbox-wrapper collapse" id="proceeds">
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockProceed" class="checkbox" name="blockProceed" filter-param th:field="*{visableSetting.blockProceed}">
                                    <label class="checkbox-label" for="blockProceed">Выручка</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockPrepaymentProceed" class="checkbox" name="blockPrepaymentProceed" filter-param th:field="*{visableSetting.blockPrepaymentProceed}">
                                    <label class="checkbox-label" for="blockPrepaymentProceed">Выручка предорлаты</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSurchargeProceed" class="checkbox" name="blockSurchargeProceed" filter-param th:field="*{visableSetting.blockSurchargeProceed}">
                                    <label class="checkbox-label" for="blockSurchargeProceed">Выручка доплаты</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockAdvertisingExpenses" class="checkbox" name="blockAdvertisingExpenses" filter-param th:field="*{visableSetting.blockAdvertisingExpenses}">
                                    <label class="checkbox-label" for="blockAdvertisingExpenses">Расходы на рекламу</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockProceedAdvertisingExpenses" class="checkbox" name="blockProceedAdvertisingExpenses" filter-param th:field="*{visableSetting.blockProceedAdvertisingExpenses}">
                                    <label class="checkbox-label" for="blockProceedAdvertisingExpenses">Выручка - Расходы на рекламу</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockPercentNetProceed" class="checkbox" name="blockPercentNetProceed" filter-param th:field="*{visableSetting.blockPercentNetProceed}">
                                    <label class="checkbox-label" for="blockPercentNetProceed">% чистой выручки</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockKPD" class="checkbox" name="blockKPD" filter-param th:field="*{visableSetting.blockKPD}">
                                    <label class="checkbox-label" for="blockKPD">КПД</label>
                                </div>
                            </div>
                        </div>
                        <div class="menu-input menu-input_xsmall">
                            <div class="menu-input__title funnel-block__btn collapsed" data-toggle="collapse"
                                 data-target="#indicators" aria-expanded="false"
                                 aria-controls="indicators">Показатели этапов воронки</div>
                            <div class="menu-input__checkbox-wrapper collapse" id="indicators">
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockShows" class="checkbox" name="blockShows" filter-param th:field="*{visableSetting.blockShows}">
                                    <label class="checkbox-label" for="blockShows">Показов</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockClicks" class="checkbox" name="blockClicks" filter-param th:field="*{visableSetting.blockClicks}">
                                    <label class="checkbox-label" for="blockClicks">Кликов</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockApplications" class="checkbox" name="blockApplications" filter-param th:field="*{visableSetting.blockApplications}">
                                    <label class="checkbox-label" for="blockApplications">Заявок</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockBills" class="checkbox" name="blockBills" filter-param th:field="*{visableSetting.blockBills}">
                                    <label class="checkbox-label" for="blockBills">Заказов</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSales" class="checkbox" name="blockSales" filter-param th:field="*{visableSetting.blockSales}">
                                    <label class="checkbox-label" for="blockSales">Оплат всего</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSalesWithoutSales" class="checkbox" name="blockSalesWithoutSales" filter-param th:field="*{visableSetting.blockSalesWithoutSales}">
                                    <label class="checkbox-label" for="blockSalesWithoutSales">Оплат без рассылки</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSalesWithSales" class="checkbox" name="blockSalesWithSales" filter-param th:field="*{visableSetting.blockSalesWithSales}">
                                    <label class="checkbox-label" for="blockSalesWithSales">Оплат с рассылки</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSurcharges" class="checkbox" name="blockSurcharges" filter-param th:field="*{visableSetting.blockSurcharges}">
                                    <label class="checkbox-label" for="blockSurcharges">Доплаты</label>
                                </div>
                            </div>
                        </div>
                        <div class="menu-input menu-input_xsmall">
                            <div class="menu-input__title funnel-block__btn collapsed" data-toggle="collapse"
                                 data-target="#clients" aria-expanded="false"
                                 aria-controls="clients">Клиенты по дате обращения</div>
                            <div class="menu-input__checkbox-wrapper collapse" id="clients">
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockClientsDO" class="checkbox" name="blockClientsDO" filter-param th:field="*{visableSetting.blockClientsDO}">
                                    <label class="checkbox-label" for="blockClientsDO">Новых клиентов по ДО</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockClientsTraffic" class="checkbox" name="blockClientsTraffic" filter-param th:field="*{visableSetting.blockClientsTraffic}">
                                    <label class="checkbox-label" for="blockClientsTraffic">Новых клиентов с трафика за период</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSalesDo" class="checkbox" name="blockSalesDo" filter-param th:field="*{visableSetting.blockSalesDo}">
                                    <label class="checkbox-label" for="blockSalesDo">Дотекло клиентов по ДО</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSalesDoWithoutMailing" class="checkbox" name="blockSalesDoWithoutMailing" filter-param th:field="*{visableSetting.blockSalesDoWithoutMailing}">
                                    <label class="checkbox-label" for="blockSalesDoWithoutMailing">Дотекло клиентов по ДО (без рассылки)</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockSalesDoWithMailing" class="checkbox" name="blockSalesDoWithMailing" filter-param th:field="*{visableSetting.blockSalesDoWithMailing}">
                                    <label class="checkbox-label" for="blockSalesDoWithMailing">Дотекло клиентов по ДО (по рассылке)</label>
                                </div>
                            </div>
                        </div>
                        <div class="menu-input menu-input_xsmall">
                            <div class="menu-input__title funnel-block__btn collapsed" data-toggle="collapse"
                                 data-target="#check" aria-expanded="false"
                                 aria-controls="check">Средний чек</div>
                            <div class="menu-input__checkbox-wrapper collapse" id="check">
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockAverage" class="checkbox" name="blockAverage" filter-param th:field="*{visableSetting.blockAverage}">
                                    <label class="checkbox-label" for="blockAverage">Средний чек</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockAveragePrepayment" class="checkbox" name="blockAveragePrepayment" filter-param th:field="*{visableSetting.blockAveragePrepayment}">
                                    <label class="checkbox-label" for="blockAveragePrepayment">Средний чек предоплаты</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockAverageSurcharge" class="checkbox" name="blockAverageSurcharge" filter-param th:field="*{visableSetting.blockAverageSurcharge}">
                                    <label class="checkbox-label" for="blockAverageSurcharge">Средний чек доплаты</label>
                                </div>
                            </div>
                        </div>
                        <div class="menu-input menu-input_xsmall">
                            <div class="menu-input__title funnel-block__btn collapsed" data-toggle="collapse"
                                 data-target="#price" aria-expanded="false"
                                 aria-controls="price">Стоимость этапов воронки</div>
                            <div class="menu-input__checkbox-wrapper collapse" id="price">
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockPriceShows" class="checkbox" name="blockPriceShows" filter-param th:field="*{visableSetting.blockPriceShows}">
                                    <label class="checkbox-label" for="blockPriceShows">Стоимость 1000 показов</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockPriceClick" class="checkbox" name="blockPriceClick" filter-param th:field="*{visableSetting.blockPriceClick}">
                                    <label class="checkbox-label" for="blockPriceClick">Стоимость клика</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockPriceApplication" class="checkbox" name="blockPriceApplication" filter-param th:field="*{visableSetting.blockPriceApplication}">
                                    <label class="checkbox-label" for="blockPriceApplication">Стоимость заявки</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockPriceBill" class="checkbox" name="blockPriceBill" filter-param th:field="*{visableSetting.blockPriceBill}">
                                    <label class="checkbox-label" for="blockPriceBill">Стоимость заказа</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockClient" class="checkbox" name="blockClient" filter-param th:field="*{visableSetting.blockClient}">
                                    <label class="checkbox-label" for="blockClient">Стоимость клиента</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockClientDO" class="checkbox" name="blockClientDO" filter-param th:field="*{visableSetting.blockClientDO}">
                                    <label class="checkbox-label" for="blockClientDO">Стоимость клиента по ДО</label>
                                </div>
                            </div>
                        </div>
                        <div class="menu-input menu-input_xsmall">
                            <div class="menu-input__title funnel-block__btn collapsed" data-toggle="collapse"
                                 data-target="#conversion" aria-expanded="false"
                                 aria-controls="conversion">Конверсии воронки</div>
                            <div class="menu-input__checkbox-wrapper collapse" id="conversion">
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockShowToClick" class="checkbox" name="blockShowToClick" filter-param th:field="*{visableSetting.blockShowToClick}">
                                    <label class="checkbox-label" for="blockShowToClick">CV из показа в клик</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockClickToApplication" class="checkbox" name="blockClickToApplication" filter-param th:field="*{visableSetting.blockClickToApplication}">
                                    <label class="checkbox-label" for="blockClickToApplication">CV из клика в заявку</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockApplicationToBill" class="checkbox" name="blockApplicationToBill" filter-param th:field="*{visableSetting.blockApplicationToBill}">
                                    <label class="checkbox-label" for="blockApplicationToBill">CV из заявки в заказ</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockBillToClient" class="checkbox" name="blockBillToClient" filter-param th:field="*{visableSetting.blockBillToClient}">
                                    <label class="checkbox-label" for="blockBillToClient">CV из заказа в оплату</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockApplicationToClient" class="checkbox" name="blockApplicationToClient" filter-param th:field="*{visableSetting.blockApplicationToClient}">
                                    <label class="checkbox-label" for="blockApplicationToClient">CV из заявки в оплату</label>
                                </div>
                                <div class="input-element__checkbox">
                                    <input type="checkbox" id="blockApplicationToClientDO" class="checkbox" name="blockApplicationToClientDO" filter-param th:field="*{visableSetting.blockApplicationToClientDO}">
                                    <label class="checkbox-label" for="blockApplicationToClientDO">CV из заявки в оплату по ДО</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="menu__footer">
                        <button js-save-setting class="button button_white">Применить изменения</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

<th:block th:insert="base :: scripts" />
<!--<script th:src="@{/js/js-menu-traffic2.js}"></script>-->
    <script th:src="@{/js/funnel-filter.js}"></script>
    <script th:inline="javascript">
        /*<![CDATA[*/
        setFunnelFilter(/*[[${filter}]]*/);
        /*]]>*/
    </script>
</body>
</html>